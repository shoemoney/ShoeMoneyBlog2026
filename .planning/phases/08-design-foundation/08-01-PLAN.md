---
phase: 08-design-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - public/fonts/space-grotesk-variable.woff2
  - public/fonts/inter-variable.woff2
  - public/fonts/jetbrains-mono-variable.woff2
  - resources/css/app.css
autonomous: true

must_haves:
  truths:
    - "All text renders in the new font stack (Space Grotesk headings, Inter body, JetBrains Mono code)"
    - "Changing --color-accent-primary updates the brand color site-wide"
    - "Tailwind utility classes like bg-surface-page, text-primary, shadow-card are available"
    - "Dark mode semantic tokens override light mode values via .dark class"
    - "No flash of unstyled text (FOUT) due to font-display: swap + size-adjust fallbacks"
  artifacts:
    - path: "public/fonts/space-grotesk-variable.woff2"
      provides: "Display heading font"
    - path: "public/fonts/inter-variable.woff2"
      provides: "Body text font"
    - path: "public/fonts/jetbrains-mono-variable.woff2"
      provides: "Code/monospace font"
    - path: "resources/css/app.css"
      provides: "Complete design token system"
      contains: "@theme"
  key_links:
    - from: "resources/css/app.css"
      to: "public/fonts/*.woff2"
      via: "@font-face src url"
      pattern: "url\\('/fonts/"
    - from: "resources/css/app.css"
      to: "Tailwind utility classes"
      via: "@theme block"
      pattern: "--color-surface-page|--color-text-primary|--font-display|--font-body"
    - from: "resources/css/app.css"
      to: ".dark class overrides"
      via: "CSS specificity"
      pattern: "\\.dark\\s*\\{"
---

<objective>
Set up the complete design token system: download and self-host three variable fonts, define the full two-layer semantic color token system in Tailwind v4's @theme block, and configure dark mode overrides.

Purpose: This is the foundation for v2.0's visual identity. Every subsequent phase (navigation, typography, dark mode, polish) builds on these tokens. Getting this right means components never use hardcoded colors -- they reference semantic tokens that automatically adapt to light/dark modes.

Output: Three .woff2 font files in public/fonts/, and a complete resources/css/app.css with @font-face declarations, @theme tokens (colors, typography, spacing, shadows, radii, transitions), and dark mode overrides.
</objective>

<execution_context>
@/Users/shoemoney/.claude/get-shit-done/workflows/execute-plan.md
@/Users/shoemoney/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-design-foundation/08-RESEARCH.md
@resources/css/app.css
@resources/views/components/layout.blade.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Download and place self-hosted variable fonts</name>
  <files>
    public/fonts/space-grotesk-variable.woff2
    public/fonts/inter-variable.woff2
    public/fonts/jetbrains-mono-variable.woff2
  </files>
  <action>
Download three variable font files in woff2 format and place them in public/fonts/:

1. **Space Grotesk Variable** (weight range 300-700): Download from Google Fonts or github.com/google/fonts. The file should be the Latin subset variable woff2. Save as `public/fonts/space-grotesk-variable.woff2`.

2. **Inter Variable** (weight range 100-900): Download from Google Fonts or rsms.me/inter. Save as `public/fonts/inter-variable.woff2`.

3. **JetBrains Mono Variable** (weight range 100-800): Download from Google Fonts or github.com/JetBrains/JetBrainsMono. Save as `public/fonts/jetbrains-mono-variable.woff2`.

To download from Google Fonts API, use curl with the CSS2 API:
```bash
# Get the CSS that contains the font URL, then extract and download the woff2 file
# Example for Inter:
curl -s "https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" -H "User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36" | grep -oP 'url\(\K[^)]+' | head -1 | xargs curl -o public/fonts/inter-variable.woff2
```

Repeat pattern for Space Grotesk (wght@300..700) and JetBrains Mono (wght@100..800).

If Google Fonts API approach fails, download directly from:
- Inter: https://github.com/rsms/inter/releases (grab InterVariable.woff2)
- Space Grotesk: https://github.com/floriankarsten/space-grotesk/releases
- JetBrains Mono: https://github.com/JetBrains/JetBrainsMono/releases

Create the public/fonts/ directory first if it does not exist.

**Important:** Only download the Latin subset (not full unicode). woff2 format only (not woff, ttf, or otf). Variable font files only (not static weight files).
  </action>
  <verify>
Run: `ls -la public/fonts/*.woff2` -- should show 3 files, each between 20KB and 200KB.
Run: `file public/fonts/*.woff2` -- should identify them as Web Open Font Format (Version 2) or similar.
  </verify>
  <done>Three .woff2 variable font files exist in public/fonts/ and are valid font files (not HTML error pages or empty files).</done>
</task>

<task type="auto">
  <name>Task 2: Implement complete design token system in app.css</name>
  <files>resources/css/app.css</files>
  <action>
Replace the entire contents of resources/css/app.css with the complete design token system. Use the code example from 08-RESEARCH.md (lines 374-640) as the definitive reference. The file must contain ALL of the following sections in this order:

1. **Imports and directives** (keep existing):
   - `@import 'tailwindcss';`
   - `@custom-variant dark (&:where(.dark, .dark *));`
   - `@plugin "@tailwindcss/typography";`
   - All existing `@source` directives (pagination, framework views, blade, js)

2. **@font-face declarations** (6 total):
   - Space Grotesk Variable: font-weight 300 700, font-display swap, with `format('woff2 supports variations')`, `format('woff2-variations')`, `format('woff2')` src list
   - Inter Variable: font-weight 100 900, same format pattern
   - JetBrains Mono Variable: font-weight 100 800, same format pattern
   - Space Grotesk Fallback: local('Arial'), size-adjust 107%, ascent-override 91%, descent-override 23%, line-gap-override 0%
   - Inter Fallback: local('Arial'), size-adjust 106.5%, ascent-override 90%, descent-override 22%, line-gap-override 0%
   - JetBrains Mono Fallback: local('Courier New'), size-adjust 92%, ascent-override 82%, descent-override 20%, line-gap-override 0%

3. **@theme block** with ALL token categories:
   - **Typography tokens:** --font-display (Space Grotesk + fallback + system-ui), --font-body (Inter + fallback + system-ui), --font-mono (JetBrains Mono + fallback + Courier New)
   - **Primitive color tokens:** Full slate scale (50-900) in oklch, blue scale (400-700), amber scale (400-600)
   - **Semantic color tokens (light defaults):** surface-page, surface-card, surface-raised, surface-overlay; text-primary, text-secondary, text-subtle, text-inverted; border-DEFAULT, border-subtle, border-strong; accent-primary, accent-primary-hover, accent-emphasis, accent-emphasis-hover
   - **Spacing scale:** 0 through 32 (matching Tailwind default scale: 0, px, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 20, 24, 28, 32)
   - **Shadow tokens:** sm, DEFAULT, md, lg, xl (using oklch for shadow colors), plus semantic: shadow-card, shadow-dropdown, shadow-modal
   - **Border radius tokens:** none, sm, DEFAULT, md, lg, xl, 2xl, full, plus semantic: radius-card, radius-button, radius-input
   - **Transition tokens:** fast (150ms), DEFAULT (250ms), slow (350ms) with cubic-bezier(0.4, 0, 0.2, 1)

4. **Dark mode overrides** -- TWO blocks with IDENTICAL values:
   - `@media (prefers-color-scheme: dark) { :root { ... } }` -- for system preference
   - `.dark { ... }` -- for manual toggle via Alpine.js
   - Both blocks override: all semantic surface colors (darker oklch), text colors (lighter oklch), border colors (darker slate refs), accent colors (use 400-level instead of 500), and shadow tokens (higher opacity for visibility on dark backgrounds)

5. **WordPress content styles** (migrated to semantic tokens):
   - `.wp-caption` -- keep `@apply my-6 mx-auto`
   - `.wp-caption img` -- keep `@apply rounded-lg shadow-md`
   - `.wp-caption figcaption` -- change `text-gray-500` to `text-subtle` (semantic token)
   - `.wp-video` -- keep as-is
   - `.wp-more` -- change `bg-gray-200` to `bg-border-DEFAULT` (semantic token)
   - REMOVE the separate `.dark .wp-caption figcaption` and `.dark .wp-more` rules -- semantic tokens handle dark mode automatically

6. **Alpine.js cloak** -- keep `[x-cloak] { display: none !important; }`

**Critical:** Do NOT remove the `--font-sans` token that currently exists. Instead, REPLACE it with the new `--font-body` token. Tailwind v4 uses `--font-sans` as the default body font, so also add `--font-sans` as an alias that points to the same stack as `--font-body` to ensure default text rendering uses Inter.

**Do NOT add:** Any `@apply` rules beyond the WordPress content styles. No component-level styles. No utility overrides.
  </action>
  <verify>
Run: `npm run build` (or `npx vite build`) -- must complete without errors.
Run: `grep -c '@font-face' resources/css/app.css` -- should return 6 (3 variable + 3 fallback).
Run: `grep -c '@theme' resources/css/app.css` -- should return 1.
Run: `grep 'text-gray-500\|bg-gray-200\|text-gray-400\|bg-gray-700' resources/css/app.css` -- should return NO matches (all migrated to semantic tokens).
Run: `grep 'text-subtle\|bg-border-DEFAULT' resources/css/app.css` -- should return matches (semantic tokens in use).
Run: `grep '\.dark .wp-' resources/css/app.css` -- should return NO matches (removed, semantic tokens handle it).
  </verify>
  <done>
resources/css/app.css contains the complete two-layer design token system with: 6 @font-face declarations (3 variable + 3 fallback), a @theme block with typography/color/spacing/shadow/radius/transition tokens, both prefers-color-scheme and .dark class overrides, WordPress content styles using semantic tokens only (no hardcoded colors), and Vite build succeeds without errors.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes successfully (CSS compiles, no Tailwind errors)
2. `ls public/fonts/*.woff2 | wc -l` returns 3
3. `grep -c '@font-face' resources/css/app.css` returns 6
4. `grep 'text-gray-\|bg-gray-' resources/css/app.css` returns NO matches (all semantic)
5. `grep '\-\-color-surface-page\|\-\-color-text-primary\|\-\-font-display\|\-\-font-body' resources/css/app.css` returns matches for all 4
</verification>

<success_criteria>
- Three variable font .woff2 files exist in public/fonts/
- app.css contains complete @theme block with all token categories
- app.css has both @media prefers-color-scheme and .dark class overrides
- WordPress content styles use semantic tokens (no hardcoded gray/white/black)
- Vite build succeeds without errors
- Tailwind generates utility classes for all semantic tokens (bg-surface-page, text-primary, etc.)
</success_criteria>

<output>
After completion, create `.planning/phases/08-design-foundation/08-01-SUMMARY.md`
</output>
