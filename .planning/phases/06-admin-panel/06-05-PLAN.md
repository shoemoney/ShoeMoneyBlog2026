---
phase: 06-admin-panel
plan: 05
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - app/Livewire/Admin/Taxonomies/CategoryManager.php
  - resources/views/livewire/admin/taxonomies/category-manager.blade.php
  - app/Livewire/Admin/Taxonomies/TagManager.php
  - resources/views/livewire/admin/taxonomies/tag-manager.blade.php
  - routes/web.php
autonomous: true

must_haves:
  truths:
    - "Admin can see list of all categories"
    - "Admin can create a new category"
    - "Admin can edit a category name and slug"
    - "Admin can delete an unused category"
    - "Admin can manage tags with same capabilities"
  artifacts:
    - path: "app/Livewire/Admin/Taxonomies/CategoryManager.php"
      provides: "Category CRUD operations"
      contains: "create"
    - path: "app/Livewire/Admin/Taxonomies/TagManager.php"
      provides: "Tag CRUD operations"
      contains: "create"
  key_links:
    - from: "app/Livewire/Admin/Taxonomies/CategoryManager.php"
      to: "App\\Models\\Category"
      via: "Eloquent CRUD"
      pattern: "Category::"
---

<objective>
Create category and tag management interfaces.

Purpose: Enable admin to manage taxonomy terms used for organizing blog content.

Output: CategoryManager and TagManager Livewire components with inline create/edit functionality.
</objective>

<execution_context>
@/Users/shoemoney/.claude/get-shit-done/workflows/execute-plan.md
@/Users/shoemoney/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-admin-panel/06-RESEARCH.md
@app/Models/Category.php
@app/Models/Tag.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CategoryManager component</name>
  <files>
    app/Livewire/Admin/Taxonomies/CategoryManager.php
    resources/views/livewire/admin/taxonomies/category-manager.blade.php
    routes/web.php
  </files>
  <action>
1. Create CategoryManager component:
   - Properties: $name, $slug, $description, $editingId (null for create, ID for edit)
   - Validation: name required|max:255, slug required|max:255|unique (exclude editingId)
   - Methods:
     - create(): validates, creates Category, resets form, flash success
     - edit(Category $category): populates form fields, sets editingId
     - update(): validates, updates category, resets form
     - cancelEdit(): resets form and editingId
     - delete(Category $category): deletes if no posts attached, else flash error
     - updatedName(): auto-generate slug from name using Str::slug()
   - render() returns all categories with posts count, ordered by name

2. Create view:
   - Header: "Categories" title
   - Create/Edit form (same form, toggles based on editingId):
     - Name input (wire:model.live for slug generation)
     - Slug input (wire:model)
     - Description textarea (wire:model)
     - Save/Update button, Cancel button (when editing)
   - Table of existing categories:
     - Columns: Name, Slug, Posts Count, Actions
     - Posts count shows withCount('posts')
     - Edit button (wire:click="edit(id)")
     - Delete button (wire:click="delete(id)" wire:confirm) - disabled if posts > 0

3. Add route:
   ```php
   Route::get('/categories', \App\Livewire\Admin\Taxonomies\CategoryManager::class)->name('admin.categories.index');
   ```

Layout: Form above table, inline editing style (form pre-fills on edit click).
  </action>
  <verify>
    php artisan livewire:list | grep CategoryManager
    php artisan route:list --path=admin/categories
  </verify>
  <done>
    - CategoryManager lists all categories with post counts
    - Can create new category
    - Can edit existing category
    - Can delete category (only if no posts)
    - Slug auto-generates from name
  </done>
</task>

<task type="auto">
  <name>Task 2: Create TagManager component</name>
  <files>
    app/Livewire/Admin/Taxonomies/TagManager.php
    resources/views/livewire/admin/taxonomies/tag-manager.blade.php
    routes/web.php
  </files>
  <action>
1. Create TagManager component (nearly identical to CategoryManager):
   - Properties: $name, $slug, $editingId
   - No description field (Tags don't have descriptions in the model)
   - Same validation, same methods (create, edit, update, cancelEdit, delete)
   - delete() prevents deletion if posts attached
   - render() returns all tags with posts count, ordered by name

2. Create view (similar to CategoryManager):
   - Header: "Tags" title
   - Create/Edit form:
     - Name input
     - Slug input
     - Save/Cancel buttons
   - Table:
     - Columns: Name, Slug, Posts Count, Actions
     - Edit/Delete buttons

3. Add route:
   ```php
   Route::get('/tags', \App\Livewire\Admin\Taxonomies\TagManager::class)->name('admin.tags.index');
   ```

Note: Tags table will be longer (15K+ tags from WordPress). Consider adding search or pagination if performance is an issue, but start simple with paginate(50).
  </action>
  <verify>
    php artisan livewire:list | grep TagManager
    php artisan route:list --path=admin/tags
  </verify>
  <done>
    - TagManager lists all tags with post counts
    - Can create new tag
    - Can edit existing tag
    - Can delete tag (only if no posts)
    - Pagination handles large tag set
  </done>
</task>

</tasks>

<verification>
- [ ] /admin/categories shows all categories
- [ ] Category create form works
- [ ] Category edit pre-fills form
- [ ] Category delete works (if no posts)
- [ ] Category delete blocked if posts attached
- [ ] /admin/tags shows all tags with pagination
- [ ] Tag CRUD works same as categories
- [ ] Slug auto-generation works on both
</verification>

<success_criteria>
1. Admin can view all categories with post counts
2. Admin can create new category with name/slug/description
3. Admin can edit existing category
4. Admin can delete category (only if unused)
5. Admin can manage tags with same capabilities
6. Large tag set paginated appropriately
7. Slug auto-generates from name on both
</success_criteria>

<output>
After completion, create `.planning/phases/06-admin-panel/06-05-SUMMARY.md`
</output>
